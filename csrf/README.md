# Уязвимость

## Описание
CSRF (Cross Site Request Forgery — «межсайтовая подделка запроса»). Эта атака позволяет производить различные действия на уязвимом сайте от имени аутентифицированного пользователя. Для её реализации злоумышленник "заманивает" жертву на сайт, содержащий скрытую форму уже заполненную злоумышленником. Эта форма должна отправляться на уязвимый сайт. Она содержит значения, которые может выполнить только авторизованный пользователь. Браузер жертвы, при загрузке сайта злоумышленника, обрабатывает эту форму, т.е. осуществляет отправку формы на уязвимый сайт со значениями, заранее написанными злоумышленником. По стандартам HTTP при обращении к сайту браузер должен отправить запрос с приложением файла куки, в котором содержится идентификатор авторизации, если она была. Тем самым уязвимый сайт не подозревает, что форма была отправлена злоумышленником, а не пользователем.

## Классификация
Web application vulnerability

## Условия
- ОС: любая
- язык: любой
- компоненты: куки,токены
- настройки: JS

## Детектирование
Проветить POST запросы,cookie.

## Эксплуатация
Эксплуатация заключается в привлечении пользователя на сайт с уязвимостью,ожидая что пользователь авторизован на сайте(существует сессионая кука) не защищенного от CSRF,для которого у нас есть скрипт выполнения какого-то действия

### Инструменты
- знание JS
- как использовать POST запроса в http 

## Ущерб
Получение логина и пароля. 

## Защита
Популярные варианты защиты от CSRF
1. CSRF token 
2. Double submit cookie
3. Content-Type based protection
4. Referer-based protection
5. Password confirmation / websudo
6. SameSite Cookies в Chrome, Opera

### Основные меры
 Генерировать новый токен на каждый запроc
 Ограничиваем время жизни cookie, которое содержит токен, разумным значением. 
 Делаем cookie недоступной из JS (ставим HTTPOnly=true)
 Размер токена не менее 32 байт.
 Генерируем токен криптографически стойким генератором псевдослучайных чисел.


## Дополнительно


## Обход защиты
1. XSS (cross-sitescripting)
2. Dangling markup
3. Уязвимый субдомен
4. Cookie injection
5. Spoof Referer
